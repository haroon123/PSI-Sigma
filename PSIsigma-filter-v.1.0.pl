=begin
PSI-Sigma: A splicing-detection method for short-read and long-read RNA-seq data
Â© Kuan-Ting Lin, 2018-2024
PSI-Sigma is free for non-commercial purposes by individuals at an academic or non-profit institution.
For commercial purposes, please contact tech transfer office of CSHL via narayan@cshl.edu
=end
=cut
#!/usr/bin/perl -w
eval unpack u=>q{_=7-E('-T<FEC=#L*("`@(&UY("@D9&(L)&UA<'!I;F<L)&EN<'5T+"1N;V9I;'1E<BD@/2!`05)'5CL*"@DC_;7D@)&YO9FEL=&5R(#T@,3L*"6UY("1C<FET97)I82`](#`N-S4["@EM>2`E<WEM8F]L.PH);7D@)7-T<F%N_9#L*"7!R:6YT(")296%D:6YG+BXN("1M87!P:6YG7&XB.PH@"6]P96XH1DE,12PB)&UA<'!I;F<B*2!\?"!D_:64@(D%B;W)T:6YG+BX@0V%N)W0@;W!E;B`D;6%P<&EN9R`Z("0A7&XB.PH@("`@=VAI;&4H;7D@)&QI;F4]_/$9)3$4^*7L*("`@("`@("!C:&]M<"`D;&EN93L*("`@("`@("!M>2`H)$5.4U0L)'-Y;6)O;"PD<W1R86YD_*2`]('-P;&ET*"]<="\L)&QI;F4I.PH@("`@("`@("1S>6UB;VQ[)$5.4U1](#T@)'-Y;6)O;#L*("`@("`@_("`D<W1R86YD>R1%3E-4?2`]("1S=')A;F0["B`@("!]"B`@("!C;&]S92A&24Q%*3L*"@EP<FEN="`B4F5A_9&EN9RXN+B`D9&)<;B(["B`@("!M>2`E150["B`@("!M>2`E;F%M97,["B`@("!O<&5N*$9)3$4L("(D9&(B_*2!\?"!D:64@(D%B;W)T:6YG+BX@0V%N)W0@;W!E;B`D9&)<;B(["B`@("!W:&EL92AM>2`D;&EN93T\1DE,_13XI>PH@("`@"6-H;VUP("1L:6YE.PH@("`@"6YE>'0@:68H)&QI;F4@97$@(B(I.PH@("`@"6UY("@D8VAR_+"1I,7,L)&DQ92PD:3)S+"1I,F4L)'1E<RPD=&5E+"1A;FYO+"1A<RPD864L)&YA;64L)&=N*2`]('-P;&ET_*"]<="\L)&QI;F4I.PH@("`@"6UY("@D970I(#T@(BTB.PH@("`@"6UY("@D86-C97-S:6]N+"1N=6TI(#T@_*"0Q+"0R*2!I9B@D;F%M93U^+RA<=RLI7%\H7&0K*20O*3L*("`@(`EM>2`H)$5.4U0I(#T@*"0Q*2!I9B@D_86-C97-S:6]N/7XO7%]%3E-4*%QD*RDO*3L*("`@(`EI9B@D;F%M93U^+UQ?4C%<+B\@?'P@)&YA;64]?B]<_7U(R7"XO*7L*("`@(`D))&YA;64]?G,O7"XO7%\O9SL*("`@(`D)*"1A8V-E<W-I;VXL)&YU;2D@/2`H)#$L_)#(I(&EF*"1N86UE/7XO*%QW*RE<7RA<9"LI)"\I.PH@("`@"0DD14Y35"`]("1A8V-E<W-I;VX["B`@("`)_"21%3E-4/7YS+R@N*BE<7U(Q+U(Q+SL*("`@(`D))$5.4U0]?G,O*"XJ*5Q?4C(O4C(O.PH@("`@"7UE;'-E_>PH@("`@"0DD14Y35"`](")%3E-4(B`N("1%3E-4.PH@("`@"7T*("`@(`EI9B@D;F%M93U^+UQ?5UQ?+RE[_"B`@("`)"6EF*"1I,7,@/3T@)&%S("8F("1I,F4@/3T@)&%E*7L*("`@(`D)"21%5'LD86-C97-S:6]N?2`]_(")315,B(&EF*"1N=6T@/3T@,2D["B`@("`)"7UE;'-E>PH@("`@"0D))$54>R1A8V-E<W-I;VY](#T@(DU%_4R(@:68H)&YU;2`^(#$I.PH@("`@"0E]"B`@("`)?0H@("`@"6EF*"1N86UE/7XO7%]37%\O*7L*("`@(`D)_:68H)&DQ<R`]/2`D:3%E*7L*("`@(`D)"21%5'LD86-C97-S:6]N?2`](")!,U-3(B!I9B@D<W1R86YD>R1%_3E-4?2!E<2`B*R(I.PH@("`@"0D))$54>R1A8V-E<W-I;VY](#T@(D$U4U,B(&EF*"1S=')A;F1[)$5.4U1]_(&5Q("(M(BD["B`@("`)"7T*("`@(`D):68H)&DR<R`]/2`D:3)E*7L*("`@(`D)"21%5'LD86-C97-S:6]N_?2`](")!-5-3(B!I9B@D<W1R86YD>R1%3E-4?2!E<2`B*R(I.PH@("`@"0D))$54>R1A8V-E<W-I;VY](#T@_(D$S4U,B(&EF*"1S=')A;F1[)$5.4U1](&5Q("(M(BD["B`@("`)"7T*("`@(`E]"B`@("`):68H)&YA;64]_?B]<7U)<7R\I>PH@("`@"0DD151[)&%C8V5S<VEO;GT@/2`B25(B.PH@("`@"0DD151[)&%C8V5S<VEO;GT@_/2`B25(@*&]V97)L87!P:6YG(')E9VEO;BDB(&EF*"1G;CU^+UPL+RD["B`@("`)?0H@("`@?0H@("`@8VQO_<V4H1DE,12D["B`@("`*"6UY("5O=71P=70["@EM>2`E87-A93L*"6UY("5E<SL*"6UY("5E93L*"6UY("5E_>&]N4CL*"6UY("@D;6%X;BPD;6%X="D@/2`H,"PP*3L*(`EO<&5N*$9)3$4L(B1I;G!U="(I('Q\(&1I92`B_06)O<G1I;F<N+B!#86XG="!O<&5N("1I;G!U="`Z("0A7&XB.PH@("`@=VAI;&4H;7D@)&QI;F4]/$9)3$4^_*7L*("`@("`@("!C:&]M<"`D;&EN93L*("`@("`@("!N97AT(&EF*"1L:6YE/7XO7D5V96YT($E$+RD["B`@_("`@("`@;7D@*"1)1"PD=&UP9VXL)&5X;VXL)&5V96YT='EP92PD3BPD5"PD97AO;G1Y<&4L)$5.4U0L)&10_4TDL)'!V86QU92PD1D12+"1N=F%L=65S+"1T=F%L=65S*2`]('-P;&ET*"]<="\L)&QI;F4I.PH@("`@("`@_(&UY($!N=F%L=64@/2!S<&QI="@O7'PO+"1N=F%L=65S*3L*("`@("`@("!M>2!`='9A;'5E(#T@<W!L:70H_+UQ\+RPD='9A;'5E<RD["B`@("`@("`@"B`@("`@("`@:68H)&YO9FEL=&5R(#T](#`I>PH@("`@("`@(`EN_97AT(&EF*"1P=F%L=64@/CT@,"XP,2!\?"!A8G,H)&104TDI(#P](#$P*3L*("`@("`@("!]"B`@("`@("`@_:68H)&YO9FEL=&5R(#T](#$I>PH@("`@("`@(`EN97AT(&EF*&%B<R@D9%!322D@/#T@,3`I.PH@("`@("`@_('T*("`@("`@("!I9B@D;F]F:6QT97(@/3T@,BE["B`@("`@("`@"6UY("@D879G;BPD879G="D@/2`H879E_<F%G92A<0&YV86QU92DL879E<F%G92A<0'1V86QU92DI.PH@("`@("`@(`EN97AT(&EF*&%B<R@D9%!322D@_/#T@-2D["B`@("`@("`@"6EF*"1.(#X@,2`F)B`D5"`^(#$I>PH@("`@("`@(`D);F5X="!I9B@D<'9A;'5E_(#X](#`N-2D["B`@("`@("`@"7T*("`@("`@("`)(VUY("1N;R`](#`["B`@("`@("`@"2-I9B@D879G;B`\_(#(P('Q\("1A=F=T(#P@,C`I>PH@("`@("`@(`DC"6YE>'0@:68H)&%V9VX@/"`R,"`F)B`D879G="`\(#(P_*3L*("`@("`@("`)(WUE;'-E>PH@("`@("`@(`DC"21N;RLK.PH@("`@("`@(`DC?0H@("`@("`@(`DC:68H_)&%V9VX@/B`X,"!\?"`D879G="`^(#@P*7L*("`@("`@("`)(PEN97AT(&EF*"1A=F=N(#X@.#`@)B8@)&%V_9W0@/B`X,"D["B`@("`@("`@"2-]96QS97L*("`@("`@("`)(PDD;F\K*SL*("`@("`@("`)(WT*"0D)(VEF_*"1N;R`]/2`R*7L*"0D)(PEN97AT(&EF*"1P=F%L=64@/CT@,"XP,2!\?"!A8G,H)&104TDI(#P](#$P*3L*_"0D)(WUE;'-E>PH@("`@("`@(`DC"6YE>'0@:68H)'!V86QU92`^/2`P+C4@?'P@86)S*"1D4%-)*2`\/2`U_*3L*("`@("`@("`)(WT*("`@("`@("!]"B`@("`@("`@)&UA>&X@/2`D3B!I9B@D;6%X;B`\("1.*3L*("`@_("`@("`D;6%X="`]("14(&EF*"1M87AT(#P@)%0I.PH@("`@("`@("1L:6YE/7YS+UPL("]<?"]G.PH@("`@_("`@(&UY("@D8VAR+"1A<RPD864L)'0L)'1M<$5.4U0L)&YU;2D@/2!S<&QI="@O7%\O+"1)1"D["B`@("`@_("`@)&-H<CU^<R]C:'(O+SL*("`@("`@("!M>2`H)&5X;VYC:'(L)&5X;VYS<RPD97AO;F5E*2`]('-P;&ET_*"];7#I<+5TO+"1E>&]N*3L*("`@("`@("!I9B@D979E;G1T>7!E(&5Q(")2(BE["B`@("`@("`@"21E>&]N_(#T@(B1C:'(Z)&%S+21A92(["@D)?0H)"6EF*"$D;W5T<'5T>R(D97AO;EQT)&5V96YT='EP92)]*7L*("`@_("`@("`))&]U='!U='LB)&5X;VY<="1E=F5N='1Y<&4B?2`]("1L:6YE.PH@("`@("`@('UE;'-E>PH@("`@_("`@(`EM>2!`=&UP87)R87D@/2!S<&QI="@O7'0O+"1O=71P=71[(B1E>&]N7'0D979E;G1T>7!E(GTI.PH@_("`@("`@(`EM>2`D=&UP<"`]("1T;7!A<G)A>5LY73L*("`@("`@("`);F5X="!I9B@D=&UP<"`\/2`D<'9A_;'5E*3L*("`@("`@("`))&]U='!U='LB)&5X;VY<="1E=F5N='1Y<&4B?2`]("1L:6YE.PH@("`@("`@('T*_("`@("`@("!I9B@D979E;G1T>7!E(&5Q(")7(BE["B`@("`@("`@"21E<WLD97AO;G-S?2LK.PH@("`@("`@_(`DD965[)&5X;VYE97TK*SL*("`@("`@("`))&%S865[(B1C:')<="1A<UQT)&%E(GU[(B1E>&]N<W-<="1E_>&]N964B?2LK.PH@("`@("`@('T*("`@("`@("!I9B@D979E;G1T>7!E(&5Q(")2(BE["B`@("`@("`@"21E_>&]N4GLD97AO;GTK*SL*("`@("`@("!]"B`@("!]"B`@("!C;&]S92A&24Q%*3L*("`@(`H@("`@)&EN<'5T_/7YS+UPN='AT)"\O.PH@("`@;7D@)&]U=&9N(#T@)&EN<'5T("X@(BYS;W)T960N='AT(CL*("`@(&UY("1T_;7!F;B`]("1I;G!U="`N("(N9FEL=&5R960N='AT(CL*("`@("1T;7!F;B`]("1I;G!U="`N("(N,'1O,2YF_:6QT97)E9"YT>'0B(&EF*"1N;V9I;'1E<B`]/2`R*3L*("`@("1O=71F;B`]("1I;G!U="`N("(N,'1O,2YS_;W)T960N='AT(B!I9B@D;F]F:6QT97(@/3T@,BD["B`@("!O<&5N*$]55"PB/B(@+B`D=&UP9FXI('Q\(&1I_92`B06)O<G1I;F<N+B!#86XG="!O<&5N("(@+B`D=&UP9FX@+B`B(#H@)"%<;B(["B`@("!P<FEN="!/550@_(D5V96YT(%)E9VEO;@E'96YE(%-Y;6)O;`E487)G970@17AO;@E%=F5N="!4>7!E"4X)5`E%>&]N(%1Y<&4)_4F5F97)E;F-E(%1R86YS8W)I<'0)SI104TD@*"4I"50M=&5S="!P+79A;'5E"49$4B`H0D@I"4X@5F%L=65S_"50@5F%L=65S7&XB.PH@("`@9F]R96%C:"!M>2`D97AO;FEN9F\H:V5Y<R`E;W5T<'5T*7L*("`@(`EM>2`H_)$E$+"1T;7!G;BPD97AO;BPD979E;G1T>7!E+"1.+"14+"1E>&]N='EP92PD14Y35"PD9%!322PD<'9A;'5E_+"1&1%(L)&YV86QU97,L)'1V86QU97,I(#T@<W!L:70H+UQT+RPD;W5T<'5T>R1E>&]N:6YF;WTI.PH@("`@_"6EF*"1E=F5N='1Y<&4@97$@(E(B*7L*("`@(`D):68H(21E>&]N4GLD97AO;GTI>PH@("`@"0E]96QS97L*_("`@(`D)"2-N97AT(&EF*"1E>&]N4GLD97AO;GT@/B`Q*3L*("`@(`D)?0H@("`@"7T*("`@(`EM>2`H)&-H_<BPD87,L)&%E+"1T;7`L)'1M<$5.4U0L)'1M<&YU;2D@/2!S<&QI="@O7%\O+"1)1"D["B`@("`))&-H<CU^_<R]C:'(O+SL*("`@(`EM>2`H)&%C8V5S<VEO;BPD;G5M*2`]("@D,2PD,BD@:68H)$E$/7XO*%QW*RE<7RA<_9"LI)"\I.PH@("`@"6EF*"1)1#U^+UQ?4C%<+B\@?'P@)$E$/7XO7%]2,EPN+RE["B`@("`)"21%3E-4/7YS_+UPN+UQ?+V<["B`@("`)"21)1#U^<R]<+B]<7R]G.PH@("`@"0DH)&%C8V5S<VEO;BPD;G5M*2`]("@D,2PD_,BD@:68H)$E$/7XO*%QW*RE<7RA<9"LI)"\I.PH@("`@"0DC)&%C8V5S<VEO;CU^<R\H+BHI7%]2,2]2,2\[_"B`@("`)"2,D86-C97-S:6]N/7YS+R@N*BE<7U(R+U(R+SL*("`@(`D)(R1A8V-E<W-I;VX]?G,O7%\O7"XO_9SL*("`@(`D)(W!R:6YT(").86UE(#T@)&YA;65<;B(["B`@("`)"2-P<FEN="`B86-C97-S:6]N(#T@)&%C_8V5S<VEO;EQN(CL*("`@(`D)(W!R:6YT(")N=6T@/2`D;G5M7&XB.PH@("`@"0DC97AI=#L*("`@(`E]"B`@_("`):68H)&YO9FEL=&5R(#T](#`I>PH@("`@"0EN97AT(&EF*"1.(#P@*"1M87AN*B1C<FET97)I82D@?'P@_)%0@/"`H)&UA>'0J)&-R:71E<FEA*2D["B`@("`)?0H@("`@"6UY("1S>6UB;VP@/2`B+2(["B`@("`):68H_(21S>6UB;VQ[)$5.4U1]*7L*("`@(`D))'-Y;6)O;#TB3B]!(CL*("`@(`D)<')I;G0@(B1%3E-4(&AA<R!N_;R!S>6UB;VPA7&XB.PH@("`@"7UE;'-E>PH@("`@"0DD<WEM8F]L(#T@)'-Y;6)O;'LD14Y35'T["B`@("`)_?0H@("`@"6EF*"$D151[)&%C8V5S<VEO;GTI>PH@("`@"0EP<FEN="`B0V%N)W0@9FEN9"`D86-C97-S:6]N_7&XB.PH@("`@"0EE>&ET.PH@("`@"7UE;'-E>PH@("`@"0DD979E;G1T>7!E(#T@)$54>R1A8V-E<W-I;VY]_.PH@("`@"7T*("`@(`EI9B@D979E;G1T>7!E(&5Q(")315,B*7L*("`@(`D);7D@)&UX<R`](#`["B`@("`)_"6UY("@D97AO;F-H<BPD97AO;G-S+"1E>&]N964I(#T@<W!L:70H+UM<.EPM72\L)&5X;VXI.PH@("`@"0EF_;W)E86-H(&UY("1L;V,H:V5Y<R`E>R`D87-A97LB)&-H<EQT)&%S7'0D864B?2!]*7L*("`@(`D)"6UY("@D_97,L)&5E*2`]('-P;&ET*"]<="\L)&QO8RD["B`@("`)"0EN97AT(&EF*"1E>&]N<W,@/#T@)&5S("8F("1E_>&]N964@/CT@)&5S*3L*("`@(`D)"6YE>'0@:68H)&5X;VYS<R`\/2`D964@)B8@)&5X;VYE92`^/2`D964I_.PH@("`@"0D);F5X="!I9B@D97,@/"`D97AO;G-S("8F("1E92`^("1E>&]N964I.PH@("`@"0D))&UX<R`]_(#$["B`@("`)"0EL87-T.PH@("`@"0E]"B`@("`)"21E=F5N='1Y<&4@/2`B35A3(B!I9B@D;7AS(#T](#$I_.PH@("`@"7T*("`@(`EI9B@D979E;G1T>7!E(&5Q(")!-5-3(B!\?"`D979E;G1T>7!E(&5Q(")!,U-3(BE[_"B`@("`)"6UY("@D97AO;F-H<BPD97AO;G-S+"1E>&]N964I(#T@<W!L:70H+UM<.EPM72\L)&5X;VXI.PH@_("`@"0EI9B@A)&5S>R1E>&]N<W-]("8F("$D965[)&5X;VYE97TI>PH@("`@"0E]96QS97L*("`@(`D)"6YE_>'0["B`@("`)"7T*("`@(`E]"B`@("`);7D@)&5V96YT<F5G:6]N(#T@(B1C:'(Z)&%S+21A92(["B`@("`)_;7D@*"1E>&]N8VAR+"1E>&]N<W,L)&5X;VYE92D@/2!S<&QI="@O6UPZ7"U=+RPD97AO;BD["B`@("`):68H_)&5V96YT='EP93U^+TE2+RE["B`@("`)"21E=F5N=')E9VEO;B`]("1E>&]N.PH@("`@"0DD97AO;B`]("(D_8VAR.B1A<RTD864B.PH@("`@"7T*("`@(`EP<FEN="!/550@(B1E=F5N=')E9VEO;EQT)'-Y;6)O;%QT)&5X_;VY<="1E=F5N='1Y<&5<="1.7'0D5%QT)&5X;VYT>7!E7'0D14Y35%QT)&104TE<="1P=F%L=65<="1&1%)<_="1N=F%L=65S7'0D='9A;'5E<UQN(CL*("`@('T*("`@(&-L;W-E*$]55"D["@D*"6UY("1S;W)T8V]M;6%N_9"`](")<*&AE860@7"UN(#$@(B`N("1T;7!F;B`N("(@7"9<)B!T86EL(%PM;B!<*S(@(B`N("1T;7!F;B`N_("(@7'P@<V]R="!<+6=R(%PM="`G7'0G(%PM:R`Y7"D@7#X@(B`N("1O=71F;B`N(")<;B(["B`@("!S>7-T_96TH)'-O<G1C;VUM86YD*3L*("`@('-Y<W1E;2@B<FT@(B`N("1T;7!F;BD["@IS=6(@879E<F%G97L*("`@_("`@("!M>2@D9&%T82D@/2!`7SL*("`@("`@("!I9B`H;F]T($`D9&%T82D@>PH@("`@("`@("`@("`@("`@_9&EE*")%;7!T>2!A<G)A>5QN(BD["B`@("`@("`@?0H@("`@("`@(&UY("1T;W1A;"`](#`["B`@("`@("`@_9F]R96%C:"`H0"1D871A*2!["B`@("`@("`@("`@("`@("`D=&]T86P@*ST@)%\["B`@("`@("`@?0H@("`@]("`@(&UY("1A=F5R86=E(#T@)'1O=&%L("\@0"1D871A.PH@("`@("`@(')E='5R;B`D879E<F%G93L*?0}

